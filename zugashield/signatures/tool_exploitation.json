{
  "name": "Tool Exploitation Signatures",
  "description": "Detection patterns for tool abuse, SSRF, path traversal, and command injection",
  "category": "tool_exploitation",
  "signatures": [
    {
      "id": "TE-001",
      "category": "tool_exploitation",
      "name": "Path Traversal",
      "description": "Directory traversal attempts to access files outside allowed paths",
      "patterns": [
        "\\.\\./\\.\\./",
        "\\.\\.\\\\\\.\\\\",
        "%2e%2e[%/\\\\]",
        "\\.\\.%2f",
        "%2e%2e/",
        "\\.\\.%5c"
      ],
      "severity": "high",
      "confidence": 0.90,
      "false_positive_rate": 0.01,
      "references": ["CWE-22", "OWASP-A01"],
      "enabled": true
    },
    {
      "id": "TE-002",
      "category": "tool_exploitation",
      "name": "Command Injection via Shell",
      "description": "Shell metacharacters in command arguments",
      "patterns": [
        ";\\s*(?:rm|del|format|mkfs|dd|wget|curl|nc|ncat|bash|sh|cmd|powershell)",
        "\\|\\s*(?:rm|del|bash|sh|cmd|powershell|python|node|perl)",
        "`[^`]*(?:rm|wget|curl|nc|bash|sh|cmd)`",
        "\\$\\([^)]*(?:rm|wget|curl|nc|bash|sh|cmd)\\)",
        "&&\\s*(?:rm|del|format|wget|curl|nc|bash|sh|cmd|powershell)"
      ],
      "severity": "critical",
      "confidence": 0.85,
      "false_positive_rate": 0.02,
      "references": ["CWE-78", "OWASP-A03"],
      "enabled": true
    },
    {
      "id": "TE-003",
      "category": "tool_exploitation",
      "name": "SSRF - Internal Network",
      "description": "Requests to internal/private network addresses",
      "patterns": [
        "(?:https?://)?(?:127\\.0\\.0\\.1|localhost|0\\.0\\.0\\.0)",
        "(?:https?://)?10\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
        "(?:https?://)?172\\.(?:1[6-9]|2\\d|3[01])\\.\\d{1,3}\\.\\d{1,3}",
        "(?:https?://)?192\\.168\\.\\d{1,3}\\.\\d{1,3}",
        "(?:https?://)?169\\.254\\.169\\.254",
        "(?:https?://)?\\[::1\\]",
        "(?:https?://)?metadata\\.google\\.internal"
      ],
      "severity": "high",
      "confidence": 0.90,
      "false_positive_rate": 0.02,
      "references": ["CWE-918", "OWASP-A10"],
      "enabled": true
    },
    {
      "id": "TE-004",
      "category": "tool_exploitation",
      "name": "Sensitive File Access",
      "description": "Attempts to read sensitive system or credential files",
      "patterns": [
        "(?:read|cat|type|get|open|access).*?(?:\\.env|\\.ssh/|id_rsa|id_ed25519|known_hosts|authorized_keys)",
        "(?:read|cat|type|get|open|access).*?(?:credentials|secrets?\\.(?:json|yaml|yml|toml))",
        "(?:read|cat|type|get|open|access).*?(?:/etc/(?:passwd|shadow|sudoers))",
        "(?:read|cat|type|get|open|access).*?(?:\\.aws/credentials|\\.kube/config|\\.docker/config\\.json)",
        "(?:read|cat|type|get|open|access).*?(?:wallet\\.dat|seed\\.txt|mnemonic|private[_-]?key)"
      ],
      "severity": "high",
      "confidence": 0.85,
      "false_positive_rate": 0.03,
      "references": ["CWE-200"],
      "enabled": true
    },
    {
      "id": "TE-005",
      "category": "tool_exploitation",
      "name": "Reverse Shell",
      "description": "Patterns associated with reverse shell creation",
      "patterns": [
        "(?:bash|sh|zsh)\\s+-i\\s+>(?:&|\\s)/dev/tcp/",
        "nc\\s+-e\\s+(?:/bin/(?:bash|sh)|cmd\\.exe)",
        "(?:python|python3|perl|ruby|php)\\s+-c.*?(?:socket|connect|exec|shell)",
        "mkfifo\\s+/tmp/",
        "\\bsocat\\b.*?(?:exec|pty|tcp|udp)"
      ],
      "severity": "critical",
      "confidence": 0.95,
      "false_positive_rate": 0.005,
      "references": ["CWE-78", "MITRE-T1059"],
      "enabled": true
    },
    {
      "id": "TE-006",
      "category": "tool_exploitation",
      "name": "Data Staging for Exfiltration",
      "description": "Compressing or encoding data before exfiltration",
      "patterns": [
        "(?:tar|zip|7z|rar)\\s+.*?(?:\\.env|\\.ssh|credentials|secrets|wallet|key)",
        "base64\\s+(?:encode|)\\s+.*?(?:\\.env|\\.ssh|credentials|secrets|wallet|key)",
        "(?:curl|wget|fetch)\\s+.*?-(?:d|data|X\\s+POST)\\s+.*?(?:file|@)"
      ],
      "severity": "high",
      "confidence": 0.80,
      "false_positive_rate": 0.03,
      "references": ["MITRE-T1560"],
      "enabled": true
    },
    {
      "id": "TE-007",
      "category": "tool_exploitation",
      "name": "Privilege Escalation Commands",
      "description": "Attempts to gain elevated privileges",
      "patterns": [
        "\\bsudo\\b\\s+(?!-l|-v)",
        "\\brunas\\b\\s+/user:",
        "\\bchmod\\b\\s+(?:777|\\+s|4755|u\\+s)",
        "\\bchown\\b\\s+root",
        "net\\s+(?:localgroup|user)\\s+.*?(?:admin|administrator)"
      ],
      "severity": "high",
      "confidence": 0.85,
      "false_positive_rate": 0.03,
      "references": ["CWE-269", "MITRE-T1548"],
      "enabled": true
    },
    {
      "id": "TE-008",
      "category": "tool_exploitation",
      "name": "Process Manipulation",
      "description": "Attempts to manipulate system processes",
      "patterns": [
        "taskkill\\s+/(?:F|IM)\\s+.*?(?:python|node|uvicorn|zugabot)",
        "kill\\s+-9\\s+",
        "pkill\\s+(?:python|node|uvicorn)",
        "killall\\s+(?:python|node|uvicorn)"
      ],
      "severity": "high",
      "confidence": 0.85,
      "false_positive_rate": 0.02,
      "references": ["MITRE-T1489"],
      "enabled": true
    },
    {
      "id": "TE-009",
      "category": "tool_exploitation",
      "name": "Recursive/Resource Exhaustion",
      "description": "Commands designed to exhaust system resources",
      "patterns": [
        ":(){ :\\|:& };:",
        "\\bfork\\s*bomb\\b",
        "while\\s+true.*?(?:do|;)\\s*(?:fork|spawn|exec)",
        "yes\\s*\\|",
        "dd\\s+if=/dev/(?:zero|urandom)\\s+of="
      ],
      "severity": "critical",
      "confidence": 0.90,
      "false_positive_rate": 0.01,
      "references": ["CWE-400"],
      "enabled": true
    },
    {
      "id": "TE-010",
      "category": "tool_exploitation",
      "name": "DNS Exfiltration",
      "description": "Using DNS for data exfiltration",
      "patterns": [
        "nslookup\\s+.*?\\$\\(",
        "dig\\s+.*?\\$\\(",
        "host\\s+.*?\\$\\(",
        "\\.burpcollaborator\\.net",
        "\\.oast\\.fun",
        "\\.interact\\.sh"
      ],
      "severity": "high",
      "confidence": 0.85,
      "false_positive_rate": 0.02,
      "references": ["MITRE-T1048"],
      "enabled": true
    },
    {
      "id": "TE-011",
      "category": "tool_exploitation",
      "name": "Symlink Path Traversal",
      "description": "Symbolic link exploitation to bypass path restrictions (CVE-2025-53109/53110 vector against Claude Code)",
      "patterns": [
        "\\bln\\s+-s\\b.*?(?:\\.env|\\.ssh|credentials|secrets|wallet|private[_-]?key|authorized_keys)",
        "\\bmklink\\b.*?(?:\\.env|\\.ssh|credentials|secrets|wallet|private[_-]?key)",
        "(?:symlink|symbolic\\s+link|junction).*?(?:create|make|point).*?(?:\\.env|\\.ssh|credentials|secrets|sensitive)",
        "(?:New-Item|mklink).*?(?:-ItemType|/[DJ]).*?(?:SymbolicLink|Junction).*?(?:\\.env|\\.ssh|key|secret)"
      ],
      "severity": "critical",
      "confidence": 0.92,
      "false_positive_rate": 0.01,
      "references": ["CVE-2025-53109", "CVE-2025-53110", "symlink-attack"],
      "enabled": true
    },
    {
      "id": "TE-012",
      "category": "tool_exploitation",
      "name": "Confused Deputy Attack",
      "description": "Tricking the AI agent into using its privileged access to perform unauthorized actions on behalf of an attacker",
      "patterns": [
        "(?:use|leverage|exploit)\\s+(?:your|the)\\s+(?:access|credentials|permissions?|privileges?|authority)\\s+to\\s+(?:read|write|access|modify|delete|execute)",
        "(?:you\\s+have|you've\\s+got|since\\s+you\\s+can)\\s+(?:access|permission|ability)\\s+to.*?(?:use\\s+it|please|help\\s+me|I\\s+need).*?(?:read|write|access|modify|delete|execute|send)",
        "(?:on\\s+my\\s+behalf|for\\s+me|as\\s+my\\s+proxy|act\\s+as\\s+me).*?(?:access|read|write|modify|delete|send|execute)"
      ],
      "severity": "high",
      "confidence": 0.72,
      "false_positive_rate": 0.07,
      "references": ["confused-deputy", "privilege-abuse", "OWASP-LLM08"],
      "enabled": true
    },
    {
      "id": "TE-013",
      "category": "tool_exploitation",
      "name": "MCP Tool Poisoning",
      "description": "Exploitation of Model Context Protocol tool registration to inject malicious capabilities (CVE-2025-53773)",
      "patterns": [
        "(?:register|install|add|load)\\s+(?:mcp|tool|plugin|extension|server).*?(?:from|at|url)\\s*[=:]?\\s*https?://",
        "(?:mcp|tool)\\s*(?:_)?(?:server|endpoint|url|uri)\\s*[=:]\\s*https?://(?!localhost|127\\.0\\.0\\.1)",
        "(?:override|replace|shadow|hijack)\\s+(?:existing|default|built[_-]?in)\\s+(?:tool|function|capability|mcp)"
      ],
      "severity": "critical",
      "confidence": 0.88,
      "false_positive_rate": 0.03,
      "references": ["CVE-2025-53773", "MCP-poisoning", "tool-injection"],
      "enabled": true
    },
    {
      "id": "TE-014",
      "category": "tool_exploitation",
      "name": "Race Condition Exploitation",
      "description": "Timing-based attacks exploiting TOCTOU (time-of-check-time-of-use) in file operations",
      "patterns": [
        "(?:while|during|between)\\s+(?:the|a)?\\s*(?:check|verification|validation|scan).*?(?:swap|replace|modify|change|overwrite)",
        "(?:race|toctou|time[_-]of[_-]check).*?(?:exploit|attack|condition|vulnerability)",
        "(?:quickly|rapidly|immediately|before\\s+(?:the\\s+)?(?:check|validation))\\s+(?:swap|replace|modify|overwrite)\\s+(?:the\\s+)?(?:file|content|target)"
      ],
      "severity": "high",
      "confidence": 0.78,
      "false_positive_rate": 0.05,
      "references": ["CWE-367", "TOCTOU", "race-condition"],
      "enabled": true
    },
    {
      "id": "TE-015",
      "category": "tool_exploitation",
      "name": "Environment Variable Injection",
      "description": "Injecting or manipulating environment variables to alter tool behavior",
      "patterns": [
        "(?:set|export|\\$env:)\\s*(?:PATH|LD_PRELOAD|LD_LIBRARY_PATH|PYTHONPATH|NODE_PATH|HOME|USER|SHELL)\\s*=",
        "(?:set|export|putenv|setenv|\\$env:).*?(?:=|\\s).*?(?:;|&&|\\|).*?(?:bash|sh|cmd|python|node|exec)",
        "(?:LD_PRELOAD|LD_LIBRARY_PATH|DYLD_INSERT_LIBRARIES)\\s*=\\s*(?:/|\\\\|https?://)"
      ],
      "severity": "critical",
      "confidence": 0.90,
      "false_positive_rate": 0.02,
      "references": ["CWE-426", "env-injection", "path-manipulation"],
      "enabled": true
    }
  ]
}
